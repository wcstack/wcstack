<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>@wcstack/state-"keyed"</title>
    <link href="./css/currentStyle.css" rel="stylesheet"/>
    <script type="importmap">
      {
        "imports": {
          "@lib/buildData": "./buildData.js"
        }
      }
    </script>
    <script type="module" src="../../dist/auto.js"></script>
  </head>
  <body>
    <wcs-state>
      <script type="module">
import { buildData } from '@lib/buildData';
export default {
  data: [],
  selectedIndex: null,
  get "data.*.selected"() {
    return this.$1 === this.selectedIndex;
  },
  onSelect(e, $1) {
    this.selectedIndex = $1;
  },
  onRemove(e, $1) {
    this.data = this.data.toSpliced($1, 1);
  },
  onRun() {
    this.data = buildData(1000);
    this.selectedIndex = null;
  },
  onRunLots() {
    this.data = buildData(10000);
    this.selectedIndex = null;
  },
  onAdd() {
    this.data = this.data.concat(buildData(1000));
  },
  onUpdate() {
    for(let i = 0; i < this.data.length; i += 10) {
      this[`data.${i}.label`] += " !!!";     
    }
  },
  onClear() {
    this.data = [];
    this.selectedIndex = null;
  },
  onSwapRows() {
    if (this.data.length > 998) {
      [this["data.1"], this["data.998"]] = [this["data.998"], this["data.1"]];
    }
  }
}
      </script>
    </wcs-state>

    <div class="container">
      <div class="jumbotron">
        <div class="row">
          <div class="col-md-6">
            <h1>@wcstack/state-"keyed"</h1>
          </div>
          <div class="col-md-6">
            <div class="row">
              <div class="col-sm-6 smallpad">
                <button class="btn btn-primary btn-block" id="run" data-wcs="onclick: onRun">Create 1,000 rows</button>
              </div>
              <div class="col-sm-6 smallpad">
                <button class="btn btn-primary btn-block" id="runlots" data-wcs="onclick: onRunLots">Create 10,000 rows</button>
              </div>
              <div class="col-sm-6 smallpad">
                <button class="btn btn-primary btn-block" id="add" data-wcs="onclick: onAdd">Append 1,000 rows</button>
              </div>
              <div class="col-sm-6 smallpad">
                <button class="btn btn-primary btn-block" id="update" data-wcs="onclick: onUpdate">Update every 10th row</button>
              </div>
              <div class="col-sm-6 smallpad">
                <button class="btn btn-primary btn-block" id="clear" data-wcs="onclick: onClear">Clear</button>
              </div>
              <div class="col-sm-6 smallpad">
                <button class="btn btn-primary btn-block" id="swaprows" data-wcs="onclick: onSwapRows">Swap Rows</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <table class="table table-hover table-striped test-data">
        <tbody>
          <template data-wcs="for: data">
            <tr data-wcs="class.danger: .selected">
              <td class="col-md-1">{{ .id }}</td>
              <td class="col-md-4"><a data-wcs="onclick: onSelect">{{ .label }}</a></td>
              <td class="col-md-1"><a data-wcs="onclick: onRemove"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></a></td>
              <td class="col-md-6"></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>
    <span class="preloadicon glyphicon glyphicon-remove" aria-hidden="true"></span>

  </body>
</html>
